---
title: "notebook"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Seurat)
library(dplyr)
library(patchwork)
```

```{r}
#test
fig <- function(width, heigth){
     options(repr.plot.width = width, repr.plot.height = heigth)
}
```

```{r}
# load data: barcode, genes, and counts
sc3_data <- Read10X(data.dir = 'input')
```

```{r}
# init Seurat object with raw counts
sc3 <- CreateSeuratObject(
  counts = sc3_data, project = "SC3v3", min.cells = 3, min.features = 200
  )
```

```{r}
# view data
sc3
sc3_data[1:5, 1:10]
```

```{r}
# find % mitochondrial DNA
sc3[["percent.mt"]] <- PercentageFeatureSet(sc3, pattern = "^MT-")
```

```{r}
# check mitochondrial percentages => violin plot of dataset quality
fig(16,9)
VlnPlot(sc3, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
```

```{r}
# Normalize read counts
sc3 <- NormalizeData(
  sc3, normalization.method = "LogNormalize", scale.factor = 10000
  )
```

```{r}
# Find top 500 most variable features
sc3 <- FindVariableFeatures(sc3, selection.method = "vst", nfeatures = 500)

# 10 most variable genes
top10_genes <- head(VariableFeatures(sc3), 10)
top10_genes
```

```{r}
# Plot variable genes and label top 10
plot1 <- LabelPoints(
  plot = plot1, points = top10_genes, repel = TRUE, xnudge = -0.8, ynudge = 0
  )
plot1
```

